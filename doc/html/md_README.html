<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>KGraph: KGraph: A Library for Approximate Nearest Neighbor Search</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">KGraph
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">KGraph: A Library for Approximate Nearest Neighbor Search </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Introduction</h1>
<p>KGraph is a library for k-nearest neighbor (k-NN) graph construction and online k-NN search using a k-NN Graph as index. KGraph implements heuristic algorithms that are extremely generic and fast:</p>
<ul>
<li>KGraph works on abstract objects. The only assumption it makes is that a similarity score can be computed on any pair of objects, with a user-provided function.</li>
<li>KGraph is among the fastest of libraries for k-NN search.</li>
</ul>
<p>For best generality, the C++ API should be used. A python wrapper is provided under the module name pykgraph, which supports Euclidean and Angular distances on rows of NumPy matrices.</p>
<h1>Building and Installation</h1>
<p>KGraph depends on a recent version of GCC with C++11 support, cmake and the Boost library. The package can be built and installed with ```sh cmake -DCMAKE_BUILD_TYPE=release . make sudo make install ```</p>
<p>A Makefile.plain is also provided in case cmake is not available.</p>
<p>The Python API can be installed with ``` python setup.py install ```</p>
<h1>Python Quick Start</h1>
<p>```python from numpy import random import pykgraph</p>
<p>dataset = random.rand(1000000, 16) query = random.rand(1000, 16)</p>
<p>index = pykgraph.KGraph(dataset, 'euclidean') index.build(reverse=-1) # index.save("index_file"); </p>
<h1>load with index.load("index_file");</h1>
<p>knn = index.search(query, K=10) # this uses all CPU threads knn = index.search(query, K=10, threads=1) # one thread, slower knn = index.search(query, K=1000, P=100) # search for 1000-nn, no need to recompute index. ```</p>
<p>Both index.build and index.search supports a number of optional keywords arguments to fine tune the performance. The default values should work reasonably well for many datasets. One exception is that reverse=-1 should be added if the purpose of building index is to speedup search, which is the typical case, rather than to obtain the k-NN graph itself.</p>
<p>Two precautions should be taken:</p>
<ul>
<li>Although matrices of both float32 and float64 are supported, the latter is not optimized. It is recommened that matrices be converted to float32 before being passed into kgraph.</li>
<li>The dimension (columns of matrices) should be a multiple of 4. If not, zeros must be padded.</li>
</ul>
<p>For performance considerations, the Python API does not support user-defined similarity function, as the callback function is invoked in such a high frequency that, if written in Python, speedup will inevitably be brought down. For the full generality, the C++ API should be used.</p>
<h1>C++ Quick Start</h1>
<p>The KGraph C++ API is based on two central concepts: the index oracle and the search oracle. (Oracle is a fancy way of calling a user-defined callback function that behaves like a black box.) KGraph works solely with object IDs from 0 to N-1, and relies on the oracles to map the IDs to actual data objects and computes the similarity. To use KGraph, the user has to extend the following two abstract classes</p>
<p>```cpp class IndexOracle { public: // returns size of dataset virtual unsigned size () const = 0; // computes similarity of object i and j virtual float operator () (unsigned i, unsigned j) const = 0; };</p>
<p>class SearchOracle { public: /// Returns the size of the dataset. virtual unsigned size () const = 0; /// Computes similarity of query and object i. virtual float operator () (unsigned i) const = 0; }; ```</p>
<p>With the oracle classes defined, index construction and online search become straightfoward:</p>
<p>```cpp</p>
<p>KGraph *index = KGraph::create();</p>
<p>if (need_to_create_new_index) { MyIndexOracle oracle(...); // subclass of <a class="el" href="classkgraph_1_1IndexOracle.html" title="Index oracle. ">kgraph::IndexOracle</a> KGraph::IndexParams params; params.reverse = -1; index-&gt;build(oracle, params); index-&gt;save("some_path"); } else { index-&gt;load("some_path"); }</p>
<p>MySearchOracle oracle(...); // subclass of <a class="el" href="classkgraph_1_1SearchOracle.html" title="Search oracle. ">kgraph::SearchOracle</a></p>
<p>KGraph::SearchParams params; params.K = K; vector&lt;unsigned&gt; knn(K); // to save K-NN ids. index-&gt;search(oracle, params, &amp;knn[0]);</p>
<p>delete index; ``` <a href="http://aaalgo.github.io/kgraph/doc/html/annotated.html">Doxygen documentation</a></p>
<p><a href="http://www.kgraph.org/">http://www.kgraph.org/</a> </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Jun 22 2016 14:00:10 for KGraph by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
